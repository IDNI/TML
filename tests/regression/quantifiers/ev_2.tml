#transitive closure
domain(0). domain(1). domain(2). domain(3).
T(?a ?b ?c ?d ?e ?f ?g ?h ?i ?j) :- {
          domain(?a) && domain(?b) && domain(?c) && domain(?d) &&
          domain(?e) && domain(?f) && domain(?g) && domain(?h) &&
          domain(?i) && domain(?j) && 
          { {?d = ?e } -> { {?a = ?c} && {?b = ?f} } } &&
          { ~{?d = ?e } -> ~{ {?a = ?c} && {?b = ?f} } } &&
          { {?c = ?d } -> {?g = ?h} } &&
          { {?c = ?e } -> {?g = ?i} } &&
          { {?c = ?f } -> {?g = ?j} } &&
          { {?d = ?e } -> {?h = ?i} } &&
          { {?d = ?f } -> {?h = ?j} } &&
          { {?e = ?f } -> {?i = ?j} }
        }.
R(0 0 2).
R(0 2 1).
R(1 0 1).

R(0 1).
R(1 2).
R(2 3).
R(1 0).
R(0 1).
R(1 2).

R(?g ?j) :- R(1 ?a ?b), R(0 ?c ?d), R(0 ?e ?f), R(?g ?h), R(?i ?j), T(?a ?b ?c ?d ?e ?f ?g ?h ?i ?j).
!R(?g ?j).
# ------------------------------------------------------------------------------
R2(0 1).
R2(1 2).
R2(2 3).
R2(1 0).
R2(0 1).
R2(1 2).
R3(?x ?y) :- R2(?x ?y).
R3(?x ?y) :- R3(?x ?z), R2(?z ?y).
!R3(?x ?y).
